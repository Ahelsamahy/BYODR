FROM byodr/tensorflow:jetpack-python27

RUN pip install --extra-index-url https://developer.download.nvidia.com/compute/redist/jp33 tensorflow-gpu

COPY ./common common/
COPY ./inference app/
WORKDIR /app

RUN pip install --no-cache-dir -r requirements.txt

# Create the user as part of the video group.
RUN useradd --uid 1000 --gid 44 --system --create-home --shell /bin/bash app

ENV PYTHONPATH "${PYTHONPATH}:/common"